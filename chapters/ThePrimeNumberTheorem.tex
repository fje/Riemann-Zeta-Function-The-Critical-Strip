The prime number theorem is a very fundamental statement about the asymptotic behaviour of the distribution of prime numbers. Based on the fact which we established in the previous chapter, that the Riemann zeta function doesn't have zeros on the line $\sigma = 1$ and by introducing Tchebychev's psi-function together with two auxiliary functions, we will have enough tools to manage to prove said theorem.


\section{Tchebychev's $\phi$ function}


\begin{definition}
	Let $\mathcal{P} = \fbr{p \in \field{N} \colon \; p \textit{ prime number}}$. We define the function
\begin{equation*}
\begin{aligned}
	&\pi \colon \field{R} \to \field{R}, \\
	&\pi(x) = \abs{\fbr{p \in \mathcal{P}: p \leq x}}
\end{aligned}
\end{equation*}
	as the prime number counting function.
\end{definition}


\begin{definition}
	The function
\begin{equation*}
\begin{aligned}
	&\psi \colon \field{R} \to \field{R}, \\
	&\psi(x) = \sum _{p^m \leq x} \log(p),
\end{aligned}
\end{equation*}
	for some prime number $p$ and positive integer $m \in \field{N}_{> 0}$ is often referred to as Tchebychev's psi-function.
\end{definition}


\begin{lemma}
	We have
\begin{equation*}
	\psi(x) = \sum _{p < x} \bbr{\frac{\log(x)}{\log(p)}} \log(p).
\end{equation*}
	where $\bbr{u}$ denotes the greatest integer $\leq u$.
\end{lemma}
\begin{proof}
	First we define
\begin{equation*}
	\Lambda(n) =
    	\left\{
    		\begin{array}{ll}
        		\log(p), & \text{if } n = p^m,\\
        		0, & \text{otherwise},
        	\end{array}
		\right.
\end{equation*}
	then it's clear that
\begin{equation*}
	\psi(x) = \sum _{1 \leq n \leq x} \Lambda(n).
\end{equation*}
	With this observation and the fact that if $p^m \leq x$ then $m \leq \frac{\log(x)}{\log(p)}$ our formula follows immediately.
\end{proof}


\section{Asymptotics of $\psi$ and $\psi_1$}


\begin{lemma}
	If $\psi(x) \sim x$ as $x \to \infty$, then $\pi(x) \sim \frac{x}{\log(x)}$ as $x \to \infty$.
\end{lemma}
\begin{proof}
	By definition we have to prove the inequalities
\begin{equation*}
	1 \leq \liminf _{x \to \infty} \pi(x) \frac{\log(x)}{x}
\end{equation*}
	and
\begin{equation*}
	\limsup _{x \to \infty} \pi(x) \frac{\log(x)}{x} \leq 1.
\end{equation*}
	At first we can make the crude estimate
\begin{equation*}
	\psi(x) = \sum _{p < x} \bbr{\frac{\log(x)}{\log(p)}} \log(p) \leq \sum _{p < x} \frac{\log(x)}{\log(p)} \log(p) = \pi(x) \log(x)
\end{equation*}
	and dividing by $x$ yields
\begin{equation*}
	\frac{\psi(x)}{x} \leq \frac{\pi(x) \log(x)}{x}.
\end{equation*}
	This asymptotic condition $\psi(x) \sim x$ implies the first inequality. For the second inequality we fix $0 < \alpha < 1$ and note that
\begin{equation*}
	\psi(x) \geq \sum _{p \leq x} \log(p) \geq \sum _{x^\alpha < p < x} \log(p) \geq \cbr{\pi(x) - \pi(x^\alpha)} \log(x^\alpha).
\end{equation*}
	and therefore
\begin{equation*}
	\psi(x) + \alpha \pi(x^\alpha) \log(x) \geq \alpha \pi(x) \log(x).
\end{equation*}
	Dividing by $x$, noting that $\pi(x^\alpha) \leq x^\alpha$ and $\psi(x) \sim x$, gives
\begin{equation*}
	1 \geq \alpha \limsup _{x \to \infty} \pi(x) \frac{\log(x)}{x}.
\end{equation*}
	Since $\alpha < 1$ is arbitrary the proof is complete.
\end{proof}


\begin{definition}
	The function
\begin{equation*}
\begin{aligned}
	&\psi_1 \colon \field{R} \to \field{R}, \\
	&\psi_1(x) = \sum _{p^m \leq x} \log(p),
\end{aligned}
\end{equation*}
	is closely related to the $\psi$-function and more convenient to deal with.
\end{definition}


\begin{lemma}
	If $\psi_1(x) \sim \frac{x^2}{2}$ as $x \to \infty$, then $\psi(x) \sim x$ as $x \to \infty$.
\end{lemma}
\begin{proof}
	It suffices to show that $\psi(x) \sim x$. This can easily be seen from the fact that if $\alpha < 1 < \beta$, then
\begin{equation*}
	\frac{1}{(1 - \alpha) x} \int _{\alpha x} \psi(u) du \leq \psi(x) \leq \frac{1}{(\beta - 1) x} \int _{x} \psi(\beta u) du.
\end{equation*}
	The proof of this double inequality relies simply on the fact that $\phi$ is increasing. Consequently we find that
\begin{equation*}
	\psi(x) \leq \frac{1}{(\beta - 1)x} \cbr{\psi_1(\beta x) - \psi_1(x)},
\end{equation*}
	and therefore
\begin{equation*}
	\frac{\psi(x)}{x} \leq \frac{1}{\beta - 1} \cbr{\frac{\psi_1(\beta x)}{(\beta x)^2} \beta^2 - \frac{\psi_1(x)}{x^2}}.
\end{equation*}
	In turn this implies
\begin{equation*}
	\limsup _{x \to \infty} \frac{\psi(x)}{x} \leq \frac{1}{\beta - 1} \cbr{\frac{1}{2} \beta^2 - \frac{1}{2}} = \frac{1}{2} (\beta + 1).
\end{equation*}
	Since this result holds for all $\beta > 1$ , we have proved that
\begin{equation*}
	\limsup _{x \to \infty} \frac{\psi(x)}{x} \leq 1. 
\end{equation*}
	For showing
\begin{equation*}
	\liminf _{x \to \infty} \frac{\psi(x)}{x} \geq 1
\end{equation*}
	we can use a similar argument with $\alpha < 1$.
\end{proof}


\begin{lemma}
	For $\sigma > 1$ we have
\begin{equation*}
	\frac{\zeta'(s)}{\zeta(s)} = \sum _{n = 1} ^\infty \frac{\Lambda(n)}{n^s}.
\end{equation*}
\end{lemma}
\begin{proof}
	We know that for $\sigma > 1$ we have
\begin{equation*}
	\log(\zeta(s)) = \sum _{m,p} \frac{p^{-ms}}{m}.
\end{equation*}
	Differentiating both expressions leads to
\begin{equation*}
	\frac{\zeta'(s)}{\zeta(s)} = \sum _{m,p} p^{-ms} \log(p) = \sum _{n = 1} ^\infty \frac{\Lambda(n)}{n^s}.
\end{equation*}
\end{proof}


\begin{lemma}
	If $c > 0$, then
\begin{equation*}
	\frac{1}{2 \pi i} = \int _{c - i \infty} ^{c + i \infty} \frac{a^s}{s(s + 1)} ds = 
		\left\{
    		\begin{array}{ll}
        		0, &\text{if } 0 \leq a \leq 1,\\
        		1 - \frac{1}{a}, &\text{if } 1 \leq a.
        	\end{array}
		\right.
\end{equation*}
\end{lemma}
\begin{proof}
\begin{figure}[!htb]
\begin{minipage}[c]{0.5\textwidth}
\centering
\begin{equation*}
\begin{aligned}
	&\begin{aligned}
		C(T) \colon \bbr{0, \pi} &\to \field{C}, \\ \phi &\mapsto c + Te^{i (\phi + \frac{\pi}{2}) },
	\end{aligned} \\
	&\begin{aligned}
		S(T) \colon \bbr{-T, T} &\to \field{C}, \\ t &\mapsto c + it
	\end{aligned}
\end{aligned}
\end{equation*}
\end{minipage}
\begin{minipage}[c]{0.5\textwidth}
\raggedleft
\begin{tikzpicture}
	[decoration={
		markings,
		mark=at position 0.7cm with {\arrow[line width=1pt]{>}},
		mark=at position 4.5cm with {\arrow[line width=1pt]{>}}
	}]
	% The axes
	\draw[help lines, very thin, ->] (-3,0) -- (3,0) coordinate (xaxis);
	\draw[help lines, very thin, ->] (0,-2) -- (0,2) coordinate (yaxis);
	\node[below, gray] at (xaxis) {$\Re(z)$};
	\node[left, gray] at (yaxis) {$\Im(z)$};

	% The path
	\path[draw,line width=0.6pt,postaction=decorate] (0.5, -1.5) -- (0.5, 1.5) -- (0.5, 1.5) arc (90:270:1.5);
	
	% The labels

	\node[below right] {$0$};

	\draw[xshift=0cm] (0,0) node[circle,fill,inner sep=1.2pt](a){};
	\draw[xshift=0cm] (0.5,0) node[circle,fill,inner sep=1.2pt](a){};
	\draw[xshift=0cm] (0.5,1.5) node[circle,fill,inner sep=1.2pt](a){};
	\draw[xshift=0cm] (0.5,-1.5) node[circle,fill,inner sep=1.2pt](a){};
	\draw[xshift=0cm] (-1,0) node[circle,fill,inner sep=1.2pt](a){};

	\node at (-1.4, 1) {$C(T)$};
	\node at (1.2, -0.8) {$S(T)$};
	
	\node at (0.8, 0.2) {$c$};
	\node at (1.2, 1.5) {$c + iT$};
	\node at (1.2, -1.5) {$c - iT$};
	\node at (-1.3, -0.3) {$T$};
\end{tikzpicture}
\end{minipage}
\caption{Contour $\Gamma(T)$}
\label{fig:ContourGamma}
\end{figure}
	First note that since $\abs{a^s} = a^c$, the integral converges. Suppose that $1 \leq a$, and write $a = e^\beta$ with $\beta = \log(a) \geq 0$. Let
\begin{equation*}
	f(s) = \frac{a^s}{s(s + 1)} = \frac{e^{s \beta}}{s(s + 1)}.
\end{equation*}
	Then $\res(f(s), 0) = 1$ and $\res(f(s), 1) = -\frac{1}{a}$. For $T > 0$, consider the path $\Gamma(T)$ shown in Figure. Now, we choose $T$ large enough that $0$ and $-1$ are contained in the interior of the contour $\Gamma(T)$. By the residue formula we get
\begin{equation*}
	\frac{1}{2 \pi i} \int _{\Gamma(T)} f(s) ds = 1 - \frac{1}{a}.
\end{equation*}
	Since
\begin{equation*}
	\int _{\Gamma(T)} f(s) ds = \int _{S(T)} f(s) ds + \int _{C(T)} f(s) ds,
\end{equation*}
	it suffices to show that the integral over $C(T)$ goes to $0$ as $T \to \infty$. Note that if $s \in C(T)$, then for all large $T$ we have
\begin{equation*}
	\abs{s(s + 1)} \geq \frac{1}{2} T^2.
\end{equation*}
	and since $\sigma \leq c$ we also have the estimate $\abs{e^{\beta s}} \leq e^{\beta c}$. Therefore
\begin{equation*}
	\lim _{T \to \infty} \abs{\int _{C(T)} f(s) ds} \leq \frac{C}{T^2} 2 \pi T^2 = 0
\end{equation*}
	and the case where a $\geq$ is proved. If $0 < a \leq 1$ we consider the half circle lying to the right of $S(T)$. Noting there are no poles in the interior of the contour we can give a similar argument that the integral over the half circle vanishes for $T \to \infty$.
\end{proof}


\begin{lemma}
	For all $c > 1$ we have
\begin{equation*}
	\psi_1(x) = \frac{1}{2 \pi i} \int _{c - i\infty} ^{c + i \infty} \frac{x^{s + 1}}{s(s + 1)} \cbr{-\frac{\zeta'(s)}{\zeta(s)}} ds.
\end{equation*}
\end{lemma}
\begin{proof}
	We first observe that
\begin{equation*}
	\psi(u) = \sum _{n=1} ^\infty \Lambda(n) f_n(u),
\end{equation*}
	where
\begin{equation*}
	f_n(u) = 
		\left\{
    		\begin{array}{ll}
        		1, &\text{if } n \leq u,\\
        		0, &\text{otherwise}.
        	\end{array}
		\right.
\end{equation*}
	Therefore
\begin{equation*}
\begin{aligned}	
	\psi_1(x)
		&= \int _0 ^x \psi(u) du = \sum _{n = 1} ^\infty \int _0 ^x \Lambda(n) f_n(u) \\ 
		&= \sum _{n \leq x} \Lambda(n) \int _n ^x du = \sum _{n \leq x} \Lambda(n)(x - n).
\end{aligned}
\end{equation*}
	This fact, together with previous Lemma where $a = \frac{x}{n}$, gives
\begin{equation*}
\begin{aligned}	
	\frac{1}{2 \pi i} \int _{c - i\infty} ^{c + i \infty} \frac{x^(s + 1)}{s(s + 1)} \cbr{-\frac{\zeta'(s)}{\zeta(s)}} ds 
		&= x \sum _{n = 1} ^\infty \Lambda(n) \frac{1}{2 \pi} \int _{c - i \infty} ^{c + i \infty} \frac{\cbr{\frac{x}{n}}^s}{s(s + 1)} ds \\
		&= x \sum _{n = 1} ^\infty \Lambda(n) \cbr{1 - \frac{n}{x}} \\
		&= \psi_1(x),
\end{aligned}
\end{equation*}
	as was to be shown.
\end{proof}


\begin{theorem}[Prime number theorem]
	We have that $\psi_1(x) \sim \frac{x^2}{2}$ as $x \to \infty$.
\end{theorem}
\begin{proof}
\begin{figure}[!htb]
\begin{minipage}[c]{0.5\textwidth}
\centering
\begin{equation*}
\begin{aligned}
	&\begin{aligned}
		C(T) \colon \bbr{0, \pi} &\to \field{C}, \\ \phi &\mapsto c + Te^{i (\phi + \frac{\pi}{2}) },
	\end{aligned} \\
	&\begin{aligned}
		S(T) \colon \bbr{-T, T} &\to \field{C}, \\ t &\mapsto c + it
	\end{aligned}
\end{aligned}
\end{equation*}
\end{minipage}
\begin{minipage}[c]{0.5\textwidth}
\raggedleft
\begin{tikzpicture}
	[decoration={
		markings,
		mark=at position 0.5cm with {\arrow[line width=1pt]{>}},
		mark=at position 3.5cm with {\arrow[line width=1pt]{>}}
	}]

	% The path
	\path[draw,line width=0.6pt,postaction=decorate] (-2.5, -2) -- (-2.5, 2);
	\path[draw,line width=0.6pt,postaction=decorate] (-0.5, -2) -- (-0.5, -1) -- (0.5, -1) -- (0.5, 1) -- (-0.5, 1) -- (-0.5, 2);
	\path[draw,line width=0.6pt,postaction=decorate] (2.5, -2) -- (2.5, -1) -- (1.8, -1) -- (1.8, 1) -- (2.5, 1) -- (2.5, 2);
	
	% The labels
	\node[below] at (-3.3, 0) {$s = 1$};
	\node[below] at (-0.5, 0) {$s = 1$};
	\node[below] at (2.5, 0) {$s = 1$};
	
	\node[below] at (-2.5, -2.62) {$\sigma = c$};
	\node[below] at (-0.5, -2.5) {$\gamma(T)$};
	\node[below] at (2.5, -2.5) {$\gamma(T, \delta)$};
	
	\node[right] at (2.5, -1.5) {$\gamma_1$};
	\node[below] at (2.1, -1) {$\gamma_2$};
	\node[left] at (1.8, 0) {$\gamma_3$};
	\node[above] at (2.1, 1) {$\gamma_4$};
	\node[right] at (2.5, 1.5) {$\gamma_5$};
	
	\draw[xshift=0cm] (-3.3,0) node[circle,fill,inner sep=1.2pt](a){};	
	\draw[xshift=0cm] (-0.5,0) node[circle,fill,inner sep=1.2pt](a){};
	\draw[xshift=0cm] (2.5,0) node[circle,fill,inner sep=1.2pt](a){};

	

\end{tikzpicture}
\end{minipage}
\caption{Contour $\Gamma(T)$}
\label{fig:ContourGamma}
\end{figure}
	We first fix $c > 1$, say $c = 2$ and assume that $x$ is also fixed with $x \geq 2$. Let $F(s)$ denote the integrand
\begin{equation*}
	F(s) = \frac{x^{s + 1}}{s(s + 1)} \cbr{-\frac{\zeta'(s)}{\zeta(s)}}.
\end{equation*}
	Now we deform the vertical line from $c - i \infty$ to $c + i \infty$ to the path shown in Figure. Cauchy's theorem allows us to see that
\begin{equation*}
	\frac{1}{2 \pi i} \int _{c - i \infty} ^{c + i \infty} F(s) ds = \frac{1}{2 \pi i} \int _{\gamma(T)} F(s) ds.
\end{equation*}
	Indeed we know on the basis of Proposition that $\abs{\frac{\zeta'(s)}{\zeta(s)}} \leq A\abs{t}^\eta$ for any fixed $\eta > 0$ whenever $\sigma \geq 1$ and $\abs{t} \geq 1$. Thus $\abs(F(s)) \leq A'\abs{t}^{-2 + \eta}$ in the two rectangles bounded by the line $(c - i \infty, c + i\infty)$ and $\gamma(T)$, and its decrease at infinity is rapid enough, the assertion is established.
	Next we pass from the contour $\gamma(T)$ to the contour $\gamma(T, \delta)$. For fixed T, we chose $\delta > 0$ small enough so that $\zeta$ has no zeros in the box
\begin{equation*}
	\fbr{s \in \field{C} \colon 1 - \delta \leq \sigma \leq 1, \abs{t} \leq T}.
\end{equation*}
	Such a choice can be made since $\zeta$ does not vanish on the line $\sigma = 1$. Now $F(s)$ has a simple pole at $s = 1$. In fact, by Corollary, we know that $\zeta(s) = \frac{1}{s - 1} + H(s)$, where $H(s)$ is regular near $s = 1$. Hence $-\frac{\zeta'(s)}{\zeta(s)} =\frac{1}{s - 1} + h(s)$, where $h(s)$ is holomorphic near $s = 1$, and so we have $\res(F(s), 1) = \frac{x^2}{2}$. As a result
\begin{equation*}
	\frac{1}{2 \pi i} \int _{\gamma(T)} F(s) ds = \frac{x^2}{2} + \frac{1}{2 \pi i} \int _{\gamma(T, \delta)} \frac{x^{s + 1}}{s(s + 1)} F(s) ds.
\end{equation*}
	We now the contour $\gamma(T, \delta)$ as $\gamma_1, \gamma_2, \gamma_3, \gamma_4, \gamma_5$ and estimate each of the integrals over $\gamma_j, j=1,2,3,4,5$. First we contend that there exists $T$ so large that
\begin{equation*}
	\abs{\int _{\gamma_1} F(s) ds}\leq \frac{\eps}{2} x^2
\end{equation*}
	and
\begin{equation*}
	\abs{\int _{\gamma_5} F(s) ds}\leq \frac{\eps}{2} x^2.
\end{equation*}
	To see this, we first note that for $s \in \gamma_1$ one has
\begin{equation*}
	\abs{x^{1 + s}} = x^{1 + \sigma} = x^2.
\end{equation*}
	Then by proposition we have, for example, that $\abs{\frac{\zeta'(s)}{\zeta(s)}} \leq A \abs{t}^{\frac{1}{2}}$, so
\begin{equation*}
	\abs{\int _{\gamma_1} F(s) ds} \leq C x^2 \int _T ^\infty \frac{\abs{t}\frac{1}{2}}{t^2} dt.
\end{equation*}
	Since the integral converges, we can make the right-hand side $\leq \eps \frac{x^2}{2}$ upon taking $T$ sufficiently large.The argument for the integral over $\gamma_5$ is the same. Having now fixed $T$, we choose $\delta$ appropriately small. On $\gamma_3$, note that
\begin{equation*}
	\abs{x^{1 + s}} = x^{1 + 1 - \delta} = x^{2 - \delta},
\end{equation*}
	from which we conclude that there exists a constant $C_T$ (dependent on such $T$)such that
\begin{equation*}
	\abs{\int _{\gamma_3} F(s) ds} \leq C_T x^{2 - \delta}.
\end{equation*}
	Finally, on the small horizontal segment $\gamma_2$ (and similarly on $\gamma_4$), we can estimate the integral as follows:
\begin{equation*}
	\abs{\int _{\gamma_2} F(s) ds} \leq C'_T \int _{1 - \delta} ^1 x^{1 + \sigma} d\sigma \leq C'_T \frac{x^2}{\log(x)}.
\end{equation*}
	We conclude that there exist constants $C_T$ and $C'_T$ (possibly different from the others above) such that
\begin{equation*}
	\abs{\psi_1(x) - \frac{x^2}{2}} \leq \eps x^2 + C_T x^{2 - \delta} + C'_T \frac{x^2}{\log{x}}.
\end{equation*}
	Dividing through by $\frac{x^2}{2}$, we see that
\begin{equation*}
	\abs{\frac{2 \psi_1(x)}{x^2} - 1} \leq 2\eps + 2 C_T x^{-\delta} + 2 C'_T \frac{1}{\log(x)},
\end{equation*}
	and therefore, for all large $x$ we have
\begin{equation*}
	\abs{\frac{2 \psi_1(x)}{x^2} - 1} \leq 4 \eps.
\end{equation*}
	This concludes the proof that $\psi_1(x) \sim \frac{x^2}{2}$ as $x \to \infty$.
\end{proof}